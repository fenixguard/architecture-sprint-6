# Анализ текущей архитектуры InsureTech

## Проблемы текущей архитектуры

1. **Высокая зависимость от REST API сервиса `ins-product-aggregator`**:
   - Каждый вызов сервиса требует синхронного опроса всех страховых компаний.
   - При увеличении числа компаний время обработки запроса растет линейно.
   - Сбои на стороне страховых компаний приводят к задержкам или ошибкам в работе системы.

2. **Разные интервалы обновления данных**:
   - `core-app` обновляет данные каждые 15 минут, тогда как `ins-comp-settlement` — раз в сутки.
   - Это приводит к временному рассинхрону данных, что может повлиять на корректность расчетов.

3. **Синхронное взаимодействие между сервисами**:
   - `ins-comp-settlement` зависит от данных `core-app` через REST API, что приводит к задержкам при формировании реестра оформленных страховок.

4. **Сложности с масштабированием**:
   - Увеличение количества страховых компаний требует увеличения производительности `ins-product-aggregator`, что создает узкое место в архитектуре.

5. **Отсутствие асинхронной обработки данных**:
   - Текущая синхронная модель вызывает блокировки при высокой нагрузке, снижая общую производительность системы.

6. **Ошибки взаимодействия между сервисами**:
   - Таймауты или сбои сетевых вызовов негативно влияют на стабильность работы.

## Риски планируемого роста нагрузки

1. **Рост числа страховых компаний**:
   - Увеличение числа компаний с 5 до 10 удвоит нагрузку на `ins-product-aggregator`, что может привести к деградации производительности.

2. **Снижение производительности при пиковых нагрузках**:
   - Сервисы могут не справляться с увеличением числа запросов от клиентов.

3. **Нестабильность работы системы**:
   - Возможные сбои на стороне страховых компаний усилят риск ошибок в обработке данных.

4. **Повышение времени отклика**:
   - Линейное увеличение времени обработки запросов снижает пользовательский опыт.

5. **Сложности с поддержкой и масштабированием**:
   - Текущая архитектура не готова к горизонтальному масштабированию.

## Выводы и рекомендации

- Перейти на Event-Driven архитектуру для асинхронной обработки данных.
- Внедрить брокер сообщений (например, Kafka) для передачи событий между сервисами.
- Использовать паттерн Transactional Outbox в сервисе `ins-product-aggregator` для надежной публикации данных.
- Минимизировать синхронные зависимости между сервисами.
- Обеспечить отказоустойчивость и масштабируемость системы за счет параллельной обработки событий.

---

